<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="zh">
<head>
<title>Mock Server</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <style type="text/css">
      body {
        padding-top: 60px;
        padding-bottom: 40px;
      }
      
      .fix-scoll-high{
      	margin-top: 0px;
      	<!-- height:600px; -->      	
      	overflow-y:scroll;
      	overflow-x:auto;
      }
    </style>
<link rel="stylesheet" href="/static/bootstrap/css/bootstrap.css" type="text/css"/>
<link rel="stylesheet" href="/static/bootstrap-dialog/bootstrap-dialog.css" type="text/css"/>
<link rel="stylesheet" href="/static/bootstrap-treeview/bootstrap-treeview.css" type="text/css"/>
<link rel="stylesheet" href="/static/bootstrap-switch/css/bootstrap3/bootstrap-switch.css" />

<script type="text/javascript" src="/static/js/static/require.js" data-main="/static/js/common/index.js"></script>

</head>
<BODY>

<nav class="navbar navbar-inverse navbar-fixed-top" role="navigation">
	<div class="container-fluid">
		<div class="navbar-header">
		          <a class="navbar-brand">FastMock</a>
		</div> 
		<div id="navbar" class="navbar-collapse collapse">			
	        <ul class="nav navbar-nav navbar-right">
				<li id="mockswitchli" style="margin-top: 15px">
				</li>
	            <li>
					<a href="" data-toggle="modal" data-target="#instruction">INS</a>
					<div class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" id="instruction" aria-labelledby="myLargeModalLabel">
					  <div class="modal-dialog modal-lg" role="document">
						<div class="modal-content">
							<div class="modal-header">
								<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
								<h2 class="modal-title" id="myModalLabel">Instruction</h2>
							</div>
							<div class="modal-body">
								<h3>入参内容(Parameter example):</h3>
								<code>obj={"header":{"content-length":"14","postman-token":"b26793c4-cacf-4856-bf9f-44b9424b4e3f","host":"localhost:9966","content-type":"application/x-www-form-urlencoded","connection":"keep-alive","cache-control":"no-cache","accept-encoding":"gzip, deflate","user-agent":"PostmanRuntime/7.2.0","accept":"*/*"},"content":{"a":"aaaa","b":"bbbbb"},"contentType":"application/x-www-form-urlencoded","path":"/test","method":"post"}</code>
								<h3>策略验证实例(Strategy example):</h3>
								<p>执行默认响应(Default response func):</p>
								<pre>function exec(obj) {
	return "true";
}</pre>
								<p>执行特定响应(Response specified func):</p>
								<pre>function exec(obj) {
	if (obj.header.flag == "1") {
        return "success";
    } else if (obj.header.flag == "2") {
        return "noauth";
    }
}</pre>
								<h3>策略响应实例(Strategy response example):</h3>
								<p>默认响应(Default response):</p>
								<pre>function exec(obj) {
    var obj = JSON.parse(obj)			//非必填，将入参转为json对象操作(Optional, parse obj to json)
    var resData = {				//必填，响应结果(Mandatory, response data)
        status: 200,				//必填，返回状态码。200,404,500 (Mandatory, response status code. e.x. 200,404)
        type: "json",				//必填，返回数据类型。支持json，form，xml (Mandatory, response data type. Json, form, xml is supported)
        content: {    				//非必填，返回数据(Optional, response data)
            a: obj.a,
            obj: obj
        }
    }
    return JSON.stringify(resData);		//必填，将响应结果转为json字符串(Mandatory, parse response data to json string)
}</pre>
								<p>特定响应(Specified func response)：</p>
								<pre>function success(obj) {
	内容与默认响应相同(Same as the default response)
}
function noauth(obj) {
	...
}</pre>
								<p>响应中执行特定java函数(Execute specified functions in java)：</p>
								<pre>function exec(obj) {
    var obj = JSON.parse(obj)
    var reqDataJson = {
		...
        sign: "<var class="text-primary">${reqDataSign}</var>",				//必填，函数执行结果替换(Mandatory, result of the java function will be replaced here)
    };
    var resData = {
        status: 200,
        type: "xml",
        content: reqDataJson,				//必填，返回数据(Mandatory, response data)
        var_: [{
            name: "<var class="text-primary">reqDataSign</var>",
            method: "wxSign",				//必填，待执行java函数名(Mandatory, name of java function)
            value: JSON.stringify(reqDataJson)		//必填，将执行参数转为json字符串(Mandatory, parse data to json string for java func)
        }]
    };
    return JSON.stringify(resData);
}</pre>
								<p>响应中执行特定js函数(Execute js functions in response)：</p>
								<pre>function exec(obj) {
    var obj = JSON.parse(obj)
    var resData = {
        status: ...,
        type: ...,
        content: {
			...
            radmstr: <var class="text-success">randomString()</var>				//调用函数(call function)
        }
    }
    return JSON.stringify(resData);
}
function <var class="text-success">randomString(len)</var> {　　
    len = len || 32;　　
    var chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';　　
    var maxPos = chars.length;　　
    var pwd = '';　　
    for (i = 0; i < len; i++) {　　　　
        pwd += chars.charAt(Math.floor(Math.random() * maxPos));　　
    }　　
    return pwd;
}</pre>
								<p>响应后回调(Call back after response)：</p>
								<pre>function exec(obj) {
    var obj = JSON.parse(obj)
    var resData = {
        status: ...,
        type: ...,
        content: {...}，
		//单个回调(Single call back)
		callback: <var class="text-success">callbk(obj)</var>			//必填，回调函数(Mandatory, call back function name)
		//多个回调(Multiple call back)
		//callback: [<var class="text-success">callbk1(obj)</var>,<var class="text-success">callbk2(obj)</var>]
    }
    return JSON.stringify(resData);
}
function <var class="text-success">callbk(obj)</var> {					//必填，回调函数体(Mandatory, call back function)
	var req = {
        url: "http://localhost:8180/testxmlsign",	//必填，回调接口(Mandatory, request url)
        method: "post",					//必填，请求方式(Mandatory, request method)
        datatype: "xml",				//必填，请求数据类型(Mandatory, request datatype)
        delay: 5000,					//非必填，回调延迟（ms） (Optional, delay xxx ms after response)
        content: {...}					//非必填，回调数据(Optional, request data)
		}
	return req;
}
</pre>
                                <h3>测试入参实例(Test parameter example):</h3>
                                <p>Form</p>
                                <pre>{header:{header1:"value1", header2:"value2"}, param:"a=1&b=2"}</pre>
                                <p>Json</p>
                                <pre>{header:{header1:"value1", header2:"value2"}, param:{a:1,b:2,c:"abc"}}</pre>
                                <p>Xml</p>
                                <pre>{header:{header1:"value1", header2:"value2"}, param:"&lt;xml&gt;&lt;a&gt;1&lt;/a&gt;&lt;b&gt;asdf&lt;/b&gt;&lt;/xml&gt;"}</pre>
							</div>
						</div>
					  </div>
					</div>
				</li>
				
	        </ul>
			
        </div>
    </div>
</nav>
<div class="container-fluid">
	<div class="row" id="d-project">
			<ul>
				 <li role="presentation" class="active"><a href="#">Profile</a></li>
				 <li role="presentation"><a href="#">Messages</a></li>
			</ul>
	</div>
	<div class="row" id="content">
				<pre><code >
                    Mock service for third platform:
                        Using java script for strategy and response;
                        <em>GET, POST</em> is supported for request method, other method is not verified;
                        <em>Json, Form, Xml</em> is supported for request data type. <em>Multipart/form-data</em> is currently not supported;
                        <em>Html, Json, Form, Xml</em> is supported for response data type;
                        Supporting call back function after mock response;
                    This server can be used as a proxy.
                    If you configure your host(point domain to ip of this mock server) in terminal,
                        all requests form that terminal when no strategy is hit will be forwarded to its original destination.
                    Also there is a switch for mock function on top level. If it is switched off, this server will try to forward all requests no matter if there is strategy hit.
				</code></pre>
	</div>
</div>
<div class="container" style="position: fixed; bottom: 0px; right: 10px; width: 80px; height: 70px; overflow: hidden; visibility: visible; z-index: 2147483639; background: transparent; border: 0px; transition: transform 0.2s ease-in-out 0s; backface-visibility: hidden; opacity: 1; transform: translateY(0%);">
    <img src="static/img/test.png" alt="test" id="testmock"/>
</div>
</BODY>



</html>